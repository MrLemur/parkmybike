<!-- Deprecated: legacy HTML template retained for reference. The backend now returns structured GeoJSON payloads instead. -->
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>Park My Bike - London Parking Map</title>
    <script
      type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?libraries=visualization&sensor=true_or_false&key={api_key}"
    ></script>
    <script type="text/javascript">
      function initialize() {{
        var centerlatlng = new google.maps.LatLng({lat},{long});
        var myOptions = {{
          zoom: {zoom},
          center: centerlatlng,
          disableDefaultUI: true,
          gestureHandling: "greedy",
          styles: [
            {{
              "elementType": "geometry",
              "stylers": [
                        {{
                          "color": "#ebe3cd"
                        }}
                      ]
                    }},
                    {{
                      "elementType": "labels.text.fill",
                      "stylers": [
                        {{
                          "color": "#523735"
                        }}
                      ]
                    }},
                    {{
                      "elementType": "labels.text.stroke",
                      "stylers": [
                        {{
                          "color": "#f5f1e6"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "administrative",
                      "elementType": "geometry.stroke",
                      "stylers": [
                        {{
                          "color": "#c9b2a6"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "administrative.land_parcel",
                      "elementType": "geometry.stroke",
                      "stylers": [
                        {{
                          "color": "#dcd2be"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "administrative.land_parcel",
                      "elementType": "labels.text.fill",
                      "stylers": [
                        {{
                          "color": "#ae9e90"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "landscape.natural",
                      "elementType": "geometry",
                      "stylers": [
                        {{
                          "color": "#dfd2ae"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "poi",
                      "elementType": "geometry",
                      "stylers": [
                        {{
                          "color": "#dfd2ae"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "poi",
                      "elementType": "labels.text.fill",
                      "stylers": [
                        {{
                          "color": "#93817c"
                        }}
                      ]
                    }},
                    {{
                      "featureType": "poi.park",
                      "elementType": "geometry.fill",
                      "stylers": [
                        {{
                          "color": "#a5b076"
                        }}
                      ]
                    }},
                    <!DOCTYPE html>
                    <html lang="en">
                      <head>
                        <meta charset="UTF-8" />
                        <meta
                          name="viewport"
                          content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
                        />
                        <title>Park My Bike - London Parking Map</title>
                        <link
                          rel="stylesheet"
                          href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
                          integrity="sha512-mTLM6G8z1KjqwZSmFsYFFAh14+b6w6P0L8u11RVlMCM/iNwIVDSY5Pja/qvpDMAYA9YgS1jDuU8R8nR0zs3P8Q=="
                          crossorigin=""
                        />
                        <style>
                          html,
                          body {
                            height: 100%;
                            margin: 0;
                          }
                          #map {
                            width: 100%;
                            height: 100%;
                          }
                          .leaflet-container a {
                            color: #0d6efd;
                          }
                        </style>
                      </head>
                      <body>
                        <div id="map"></div>
                        <script
                          src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
                          integrity="sha512-vAE8xx6H0v4n0oQpU9jwELyNR725LLhcCq114F8CbnMD4PlzyBbs6k8ZZr3Su2MzvulaHYodEcYamI6LG8wYAw=="
                          crossorigin=""
                        ></script>
                        <script>
                          const map = L.map('map', {{
                            zoomControl: false,
                            attributionControl: true
                          }}).setView([{lat}, {long}], {zoom});

                          L.control.zoom({{ position: 'bottomright' }}).addTo(map);

                          L.tileLayer('https://{{s}}.tile.openstreetmap.org/{{z}}/{{x}}/{{y}}.png', {{
                            maxZoom: 19,
                            attribution:
                              '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                          }}).addTo(map);

                          map.on('moveend', function () {{
                            const center = map.getCenter();
                            window.setTimeout(function () {{
                              window.parent.postMessage(['map_moved', [center.lat, center.lng]], '*');
                            }}, 500);
                          }});

                          {markers}
                        </script>
                      </body>
                    </html>
                    }},
